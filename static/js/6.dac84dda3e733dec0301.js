webpackJsonp([6],{"7OS/":function(t,e,a){"use strict";var r=a("7+uW");e.a=new r.a},Cdx3:function(t,e,a){var r=a("sB3e"),n=a("lktj");a("uqUo")("keys",function(){return function(t){return n(r(t))}})},L4kZ:function(t,e){},Y0oN:function(t,e){},fZjL:function(t,e,a){t.exports={default:a("jFbC"),__esModule:!0}},jFbC:function(t,e,a){a("Cdx3"),t.exports=a("FeBl").Object.keys},l59k:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("fZjL"),n=a.n(r),s=a("Xxa5"),o=a.n(s),i=a("exGp"),c=a.n(i),u=a("bOdI"),l=a.n(u),p=(a("3Lne"),a("SSsa")),d=(a("JRZP"),a("LK01")),v=(a("ZuV/"),a("37Xn")),f=(a("MY4N"),a("0zAV")),m=(a("i0mo"),a("Hkar")),_=(a("OWWB"),a("1fWZ")),b={name:"",props:{products:{type:Array}},data:function(){return{}},components:{},computed:{total:function(){return this.products.reduce(function(t,e){return Number(t)+Number(e.number)},0)}},methods:{minusHandle:function(t){var e=this.products.find(function(e){return e.product_id==t});0==e.number?e.number=0:e.number--},addHandle:function(t){this.products.find(function(e){return e.product_id==t}).number++},removeHandle:function(t){var e=this.products.findIndex(function(e){return e.product_id==t});this.products.splice(e,1)}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ul",{staticClass:"prodoct-list"},t._l(t.products,function(e){return a("li",{key:e.product_id,staticClass:"border-bottom"},[a("p",[a("span",{staticClass:"brand"},[t._v("【"+t._s(e.brand)+"】"+t._s(e.line))]),t._v(" "),a("span",{staticClass:"model"},[t._v(t._s(e.model))])]),t._v(" "),a("p",[t._v("条形码："+t._s(e.bar_code))]),t._v(" "),a("p",[t._v("当前库存："+t._s(e.store_stock))]),t._v(" "),a("p",{staticClass:"purchase"},[a("span",{staticClass:"title"},[t._v("采购数量：")]),t._v(" "),a("span",{staticClass:"input"},[a("i",{staticClass:"iconfont icon-minus",on:{click:function(a){return t.minusHandle(e.product_id)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.number,expression:"item.number",modifiers:{number:!0}}],staticClass:"number",attrs:{type:"number",placeholder:"0",pattern:"[0-9]*"},domProps:{value:e.number},on:{input:function(a){a.target.composing||t.$set(e,"number",t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("i",{staticClass:"iconfont icon-plus",on:{click:function(a){return t.addHandle(e.product_id)}}})])]),t._v(" "),a("span",{staticClass:"del-bg",on:{click:function(a){return t.removeHandle(e.product_id)}}},[a("i",{staticClass:"iconfont icon-del"})])])}),0),t._v(" "),t.products.length?a("div",{staticClass:"count"},[a("p",[t._v("合计总数量："+t._s(t.total))])]):t._e()])},staticRenderFns:[]};var h,k=a("VU/8")(b,C,!1,function(t){a("Y0oN")},"data-v-0e6e7f3f",null).exports,g=a("oqQY"),y=a.n(g),x=a("Dod7"),D=a("FWz8"),j=a("VKKs"),O=a("7OS/"),$={name:"neworder",data:function(){return{type:1,formData:{flag:"order_new",datetime:y()().format("YYYY-MM-DD"),store:{},products:[],remark:"",approver:[],copy:[]}}},components:(h={},l()(h,_.a.name,_.a),l()(h,m.a.name,m.a),l()(h,f.a.name,f.a),l()(h,v.a.name,v.a),l()(h,d.a.name,d.a),l()(h,p.a.name,p.a),l()(h,"ProductList",k),h),created:function(){var t=this.$route.query.type;this.type=t;var e=Object(j.a)("formData");e?this.formData=e:this._getApproverCopy()},mounted:function(){},beforeDestroy:function(){O.a.$off("selectStore",this.selectStoreHandle)},methods:{_getApproverCopy:function(){var t=this;return c()(o.a.mark(function e(){var a,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Object(x.b)(),e.next=4,Object(D.a)({flag:"approver_copy"});case 4:a=e.sent,"SUCC"===(r=a.data).recode&&(t.formData.approver=r.data.approver,t.formData.copy=r.data.copy),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,t,[[0,9]])}))()},goStore:function(){Object(j.c)("formData",this.formData),this.$router.push({name:"choosestore"})},goProduct:function(){Object(j.c)("formData",this.formData),this.$router.push({name:"selectproduct"})},onSubmit:function(){var t=this;return c()(o.a.mark(function e(){var a,r,s,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.formData,r=a.store,s=a.products,n()(r).length){e.next=3;break}return e.abrupt("return",t.$toast("请选择门店"));case 3:if(s.length){e.next=5;break}return e.abrupt("return",t.$toast("请选择产品"));case 5:return e.prev=5,e.next=8,Object(D.e)(t.formData);case 8:i=e.sent,"SUCC"===i.data.recode&&(t.$toast.success("提交成功"),Object(j.b)("formData"),setTimeout(function(){t.$router.back(-1)})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log(e.t0);case 16:case"end":return e.stop()}},e,t,[[5,13]])}))()}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-group"},[a("van-cell-group",[a("van-cell",{attrs:{value:t.formData.datetime,required:"","is-link":""}},[a("template",{slot:"title"},[a("span",{staticClass:"custom-text"},[t._v("订单日期")])])],2)],1),t._v(" "),a("van-cell-group",[1==t.type?a("van-cell",{attrs:{value:t.formData.store.store_name||"请选择",required:"","is-link":""},on:{click:t.goStore}},[a("template",{slot:"title"},[a("span",{staticClass:"custom-text"},[t._v("门店")])])],2):a("van-cell",{attrs:{value:"门店名称",required:""}},[a("template",{slot:"title"},[a("span",{staticClass:"custom-text"},[t._v("门店")])])],2)],1),t._v(" "),a("van-cell-group",{staticClass:"product-info"},[a("van-cell",{attrs:{title:"产品信息",required:""}},[a("template",{slot:"title"},[a("div",{staticClass:"add"},[a("span",{staticClass:"custom-text"},[t._v("产品信息")]),t._v(" "),a("div",{staticClass:"add-right"},[a("span",[a("i",{staticClass:"iconfont icon-scan-code"})]),t._v(" "),a("span",{staticClass:"add-hand border-left",on:{click:t.goProduct}},[a("i",{staticClass:"iconfont icon-add-hand"}),t._v("手动添加\n            ")])])])])],2)],1),t._v(" "),a("product-list",{attrs:{products:t.formData.products}}),t._v(" "),a("van-cell-group",{staticClass:"my-group"},[a("van-field",{attrs:{type:"textarea",placeholder:"请输入备注信息",rows:"3"},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}})],1),t._v(" "),a("div",{staticClass:"my-group approver-box"},[a("div",{attrs:{title:"审批人",value:"","border-intent":!1}},[t._m(0)]),t._v(" "),a("div",{staticClass:"approver"},[a("ul",{staticClass:"approver-list"},t._l(t.formData.approver,function(e,r){return a("li",{key:e.userid},[a("div",{staticClass:"user"},[a("img",{attrs:{src:e.avatar,alt:""}}),t._v(" "),a("i",{staticClass:"clear iconfont icon-remove"}),t._v(" "),a("p",[t._v(t._s(e.username))])]),t._v(" "),r<t.formData.approver.length-1?a("div",{staticClass:"line"}):t._e()])}),0)])]),t._v(" "),a("div",{staticClass:"my-group approver-box cc-box"},[a("div",{attrs:{title:"审批人",value:"","border-intent":!1}},[t._m(1)]),t._v(" "),a("div",{staticClass:"approver"},[a("ul",{staticClass:"approver-list"},t._l(t.formData.copy,function(e,r){return a("li",{key:e.userid},[a("div",{staticClass:"user"},[a("img",{attrs:{src:e.avatar,alt:""}}),t._v(" "),a("i",{staticClass:"clear iconfont icon-remove"}),t._v(" "),a("p",[t._v(t._s(e.username))])]),t._v(" "),r<t.formData.copy.length-1?a("div",{staticClass:"line"}):t._e()])}),0)])]),t._v(" "),a("div",{staticClass:"footer fixed-bottom"},[a("van-row",{},[a("van-col",{attrs:{span:"12"}},[a("van-button",{staticClass:"btn",attrs:{type:"info",size:"large"},on:{click:function(e){return t.$router.back(-1)}}},[t._v("返回")])],1),t._v(" "),a("van-col",{attrs:{span:"12"}},[a("van-button",{staticClass:"btn remind",attrs:{type:"primary",size:"large"},on:{click:t.onSubmit}},[t._v("提交审批")])],1)],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n        审批人\n        "),e("span",{staticClass:"required-tip"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n        审批通过后通知\n        "),e("span",{staticClass:"required-tip"},[this._v("*")])])}]};var w=a("VU/8")($,S,!1,function(t){a("L4kZ")},"data-v-732a2089",null);e.default=w.exports},uqUo:function(t,e,a){var r=a("kM2E"),n=a("FeBl"),s=a("S82l");t.exports=function(t,e){var a=(n.Object||{})[t]||Object[t],o={};o[t]=e(a),r(r.S+r.F*s(function(){a(1)}),"Object",o)}}});